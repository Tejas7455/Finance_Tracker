{% extends 'Expensedjango/base.html' %}
{% block title %} Dashboard {% endblock title %}
{% block content %}
<div class="container mx-auto p-6">
    <div class="text-center mb-8">
    <h1 class="text-3xl font-bold text-blue-600">Welcome to your Expense Dashboard</h1>
        <h1 class="text-2xl font-bold">{{request.user|capfirst}}</h1>
        <p>Track your income, expenses and target effectively </p>
    </div>
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 mb-8">
        <div class="bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-xl font-semibold text-gray-800">Total Income</h2>
            <p class="text-3xl font-bold text-blue-500">Rs. {{total_income|floatformat:2}}</p>
        </div>
        <div class="bg-white p-6 rounded-lg shadow-md">
             <h2 class="text-xl font-semibold text-gray-800">Total Expense</h2>
            <p class="text-3xl font-bold text-blue-500">Rs. {{total_expense|floatformat:2}}</p>
        </div>
        <div class="bg-white p-6 rounded-lg shadow-md">
             <h2 class="text-xl font-semibold text-gray-800">Net Saving</h2>
            <p class="text-3xl font-bold text-blue-500">Rs. {{net_saving|floatformat:2}}</p>
        </div>
    </div>
    <div class="bg-white p-6 rounded-lg shadow-md mb-8" x-data="{showAll:false}">
        <h2 class="text-2xl font-semibold text-gray-800 mb-4 text-center">Your Target</h2>
        <ul class="space-y-4">
     {% for item in goal_progress %}
    <li class="flex flex-col sm:flex-row justify-between sm:items-center gap-4 border-b pb-4">
        <div class="text-gray-800 w-full sm:w-2/3">
            <p class="font-semibold text-lg">{{ item.target.name }}</p>
            <p class="text-sm text-gray-600">Target: Rs. {{ item.target.target_amount|floatformat:2 }}</p>
            <p class="text-sm text-gray-600">Deadline: {{ item.target.deadline }}</p>
            <div class="w-full bg-gray-200 rounded-full h-3 mt-2">
                <div class="bg-blue-500 h-3 rounded-full transition-all duration-500"
                     style="width: {{ item.progress|floatformat:0 }}%;"></div>
            </div>
        </div>
        <div class="text-right w-full sm:w-1/3">
            <p class="text-xl font-bold text-center text-blue-600">{{ item.progress|floatformat:2 }}%</p>
            {% if item.progress >= 100 %}
                <p class="text-sm text-green-600 text-center font-semibold">ðŸŽ¯ Completed</p>
            {% endif %}
        </div>
        <a href="{% url 'edit_target' item.target.pk %}" class="inline-block px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded hover:bg-blue-700 transition duration-150 ease-in-out">
            Edit</a>
        <form method="post" action="{% url 'delete_target' item.target.pk %}" style="display:inline;">
      {% csrf_token %}
        <button type="submit" onclick="return confirm('Are you sure you want to delete this target?')" class="inline-block px-4 py-2 bg-red-600 text-white text-sm font-medium rounded hover:bg-red-700 transition duration-150 ease-in-out">
            Delete</button>
        </form>
    </li>
            {% empty %}
        <p class="text-gray-500">No targets added yet. <a href="{% url 'target' %}" class="text-blue-500 underline">Add one now</a>.</p>
            {% endfor %}
    </ul>

    </div>
    <div class="text-center">
        <a href="{% url 'target' %}" class="bg-blue-500 text-white px-6 py-2
        rounded-lg shadow-md hover:bg-blue-600 transition">Add New Target</a>

    </div>
</div>
{% endblock content %}